generator client {
  provider = "prisma-client-js"
  output   = "../generated/client"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id                  String                @id
  tenants             UserTenant[]
  ServiceCallFavorite ServiceCallFavorite[]
}

model Tenant {
  id          String        @id
  users       UserTenant[]
  ServiceCall ServiceCall[]
}

model UserTenant {
  id       Int    @id @default(autoincrement())
  user     User   @relation(fields: [userId], references: [id])
  tenant   Tenant @relation(fields: [tenantId], references: [id])
  tenantId String
  userId   String

  @@unique([userId, tenantId])
}

enum ServiceCallStatus {
  PENDING
  EXECUTED
  FAILED
}

enum Protocol {
  HTTP
}

model ServiceCall {
  id                  Int                   @id @default(autoincrement())
  tenantId            String
  tenant              Tenant                @relation(fields: [tenantId], references: [id])
  name                String
  status              ServiceCallStatus     @default(PENDING)
  protocol            Protocol
  submitted           DateTime              @default(now())
  executed            DateTime?
  scheduled           DateTime?
  ServiceCallFavorite ServiceCallFavorite[]
}

model ServiceCallFavorite {
  id            Int         @id @default(autoincrement())
  userId        String
  user          User        @relation(fields: [userId], references: [id])
  serviceCallId Int
  serviceCall   ServiceCall @relation(fields: [serviceCallId], references: [id])

  @@unique([userId, serviceCallId])
}
